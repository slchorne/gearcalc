<!-- index.html -->
<!DOCTYPE html>
<!--
-->
<html ng-app="myApp">
<head>
  <!-- required for Bootstrap-->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- load CSS from bootstrap and fontawesome via CDN -->
  <link rel="stylesheet" href="libs/bootstrap/css/bootstrap.min.css" />
  <link rel="stylesheet" href="libs/font-awesome/css/font-awesome.css" />

  <script src="libs/angular/angular.js"></script>
  <script src="gearcalc.js"></script>
</head>

<body ng-controller="myController">

<div class="container-fluid">
    <h2>Gear Calc</h2>

    <form class="form-horizontal">

    <div class="form-group">
      <label for="front" class="col-sm-2 control-label">Front</label>
      <div class="col-sm-4">
        <input type="text" class="form-control"
                ng-model="form.front"
                ng-change="calculate()";
               placeholder="">
      </div>
    </div>
    <div class="form-group">
      <label for="rear" class="col-sm-2 control-label">Rear</label>
      <div class="col-sm-4">
        <input type="text" class="form-control"
                ng-model="form.rear"
                ng-change="calculate()";
               placeholder="">
      </div>
    </div>

     <div class="form-group">
        <label for="delta" class="col-sm-2 control-label">Threshold %</label>
        <div class="col-sm-4">
            <select class="form-control"
                ng-change="calculate()";
                ng-model="form.threshold"
                >
              <option>0</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
              <option>7</option>
              <option>8</option>
              <option>9</option>
            </select>
        </div>
     </div>

     <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <div class="checkbox">
            <label>
              <input type="checkbox"
                ng-change="calculate()";
                ng-model="form.cross"
                > Ignore Cross chains
            </label>
          </div>
        </div>
     </div>

     <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <div class="checkbox">
            <label>
              <input type="checkbox"
                ng-change="calculate()";
                ng-model="form.reverse"
                > Reverse
            </label>
          </div>
        </div>
     </div>

    </form>

</div>

<div class="container-fluid">
    <div class="row">
    <div class="col-sm-10">

    <!-- <ul class="list-group">
      <li class="list-group-item"
        ng-repeat="err in errors"
        >{{err}}
    </ul> -->

    <table class="table table-condensed">
        <tr>
            <th>Gear</th>
            <th>Front</th>
            <th>Rear</th>
            <th>Ratio</th>
            <th>Gain %</th>
            <th>F Lever</th>
            <th>R Lever</th>
            <th>F Shift</th>
            <th>R Shift</th>
            <th>Visual</th>
        </tr>
        <!-- <tr ng-repeat="rec in calculate()"> -->
        <!-- Causes infiinite loops with $digest -->
        <tr ng-repeat="rec in records">
            <td class="warning">{{$index}}</td>
            <td class="{{rec.crossWarning}}">{{rec.front}}</td>
            <td class="{{rec.crossWarning}}">{{rec.rear}}</td>
            <td class="success">{{rec.ratio}}</td>
            <td class="warning {{rec.gainWarning}}"><strong>{{rec.gain}}</strong></td>
            <td>{{rec.fidx}}</td>
            <td>{{rec.ridx}}</td>
            <td class="info"><strong>{{rec.fShift}}</strong></td>
            <td class="info"><strong>{{rec.rShift}}</strong></td>

            <!-- Visualise gear sprockets -->
            <td class="col-md-4">
                <div class="progress">
                  <div class="progress-bar {{rec.rearViewColor}}"
                  role="progressbar" aria-valuenow="20" aria-valuemin="0"
                  aria-valuemax="100" style="width: {{rec.rearViewSize}}%">
                    <span class="sr-only">20% Complete</span>
                  </div>
                </div>
            </td>
        </tr>
    </table>

    <ul>
      <li
        ng-repeat="err in errors"
        >{{err}}
    </ul>


    </div> <!--col-->
    </div> <!--row-->

</div> <!--container-->

</body>
</html>
